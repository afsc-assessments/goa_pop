<SQL>
SELECT *
FROM (
  SELECT
    "year",
    "performance",
    "haul_join",
    "port_join",
    "species",
    "fmp_gear",
    "fmp_area",
    "LHS"."fmp_subarea" AS "fmp_subarea",
    "sex",
    "length",
    "frequency"
  FROM (
    SELECT
      "record_type",
      CAST("join_key" AS VARCHAR2(255)) AS "join_key",
      "species_key",
      "sex_key",
      "t_table",
      "cruise",
      "permit",
      CAST("haul_join" AS VARCHAR2(255)) AS "haul_join",
      CAST("port_join" AS VARCHAR2(255)) AS "port_join",
      "length_seq",
      "vessel",
      "haul_offload_date",
      "haul_offload",
      "gear",
      "nmfs_area",
      "latdd_start",
      "londd_start",
      "latdd_end",
      "londd_end",
      "species",
      "sex",
      "length",
      "frequency",
      "eggs",
      "year",
      "viability",
      "injury",
      "sample_system",
      "performance",
      "akfin_load_date",
      "gear_description",
      "gear_performance_description",
      "akr_gear",
      "fmp_gear",
      "fmp_area",
      "fmp_subarea",
      "species_name",
      "akr_species_code",
      "deployment_trip_pk",
      "deployment_trip_start_date",
      "deployment_trip_end_date",
      "sampling_strata",
      "sampling_strata_name",
      "sampling_strata_deployment_category",
      "sampling_strata_selection_rate",
      "monitoring_status",
      "landing_report_id",
      "akfin_vdate"
    FROM (
      SELECT
        "RECORD_TYPE" AS "record_type",
        "JOIN_KEY" AS "join_key",
        "SPECIES_KEY" AS "species_key",
        "SEX_KEY" AS "sex_key",
        "T_TABLE" AS "t_table",
        "CRUISE" AS "cruise",
        "PERMIT" AS "permit",
        "HAUL_JOIN" AS "haul_join",
        "PORT_JOIN" AS "port_join",
        "LENGTH_SEQ" AS "length_seq",
        "VESSEL" AS "vessel",
        "HAUL_OFFLOAD_DATE" AS "haul_offload_date",
        "HAUL_OFFLOAD" AS "haul_offload",
        "GEAR" AS "gear",
        "NMFS_AREA" AS "nmfs_area",
        "LATDD_START" AS "latdd_start",
        "LONDD_START" AS "londd_start",
        "LATDD_END" AS "latdd_end",
        "LONDD_END" AS "londd_end",
        "SPECIES" AS "species",
        "SEX" AS "sex",
        "LENGTH" AS "length",
        "FREQUENCY" AS "frequency",
        "EGGS" AS "eggs",
        "YEAR" AS "year",
        "VIABILITY" AS "viability",
        "INJURY" AS "injury",
        "SAMPLE_SYSTEM" AS "sample_system",
        "PERFORMANCE" AS "performance",
        "AKFIN_LOAD_DATE" AS "akfin_load_date",
        "GEAR_DESCRIPTION" AS "gear_description",
        "GEAR_PERFORMANCE_DESCRIPTION" AS "gear_performance_description",
        "AKR_GEAR" AS "akr_gear",
        "FMP_GEAR" AS "fmp_gear",
        "FMP_AREA" AS "fmp_area",
        "FMP_SUBAREA" AS "fmp_subarea",
        "SPECIES_NAME" AS "species_name",
        "AKR_SPECIES_CODE" AS "akr_species_code",
        "DEPLOYMENT_TRIP_PK" AS "deployment_trip_pk",
        "DEPLOYMENT_TRIP_START_DATE" AS "deployment_trip_start_date",
        "DEPLOYMENT_TRIP_END_DATE" AS "deployment_trip_end_date",
        "SAMPLING_STRATA" AS "sampling_strata",
        "SAMPLING_STRATA_NAME" AS "sampling_strata_name",
        "SAMPLING_STRATA_DEPLOYMENT_CATEGORY" AS "sampling_strata_deployment_category",
        "SAMPLING_STRATA_SELECTION_RATE" AS "sampling_strata_selection_rate",
        "MONITORING_STATUS" AS "monitoring_status",
        "LANDING_REPORT_ID" AS "landing_report_id",
        "AKFIN_VDATE" AS "akfin_vdate"
      FROM (norpac.debriefed_length_mv) "q01"
    ) "q02"
  ) "LHS"
  LEFT JOIN (
    SELECT
      "fmp_subarea",
      "gear_type",
      CAST("join_key" AS VARCHAR2(255)) AS "join_key",
      "haul_seq"
    FROM (
      SELECT
        "RECORD_TYPE" AS "record_type",
        "JOIN_KEY" AS "join_key",
        "T_TABLE" AS "t_table",
        "CRUISE" AS "cruise",
        "PERMIT" AS "permit",
        "VESSEL" AS "vessel",
        "VESSEL_LENGTH" AS "vessel_length",
        "HAUL_SEQ" AS "haul_seq",
        "HAUL_JOIN" AS "haul_join",
        "TRIP_SEQ" AS "trip_seq",
        "TRIP_JOIN" AS "trip_join",
        "HAUL_DATE" AS "haul_date",
        "HAUL" AS "haul",
        "HAUL_PURPOSE_CODE" AS "haul_purpose_code",
        "GEAR_TYPE" AS "gear_type",
        "PERFORMANCE" AS "performance",
        "VESSEL_TYPE" AS "vessel_type",
        "DEPLOYMENT_DATE" AS "deployment_date",
        "DEPLOY_LATITUDE" AS "deploy_latitude",
        "DEPLOY_LONGITUDE" AS "deploy_longitude",
        "DEPLOY_LONGITUDE_CONVERTED" AS "deploy_longitude_converted",
        "DEPLOY_LONGITUDE_SECONDS" AS "deploy_longitude_seconds",
        "DEPLOY_LATITUDE_SECONDS" AS "deploy_latitude_seconds",
        "DEPLOY_E_W" AS "deploy_e_w",
        "FISHING_DEPTH_FATHOMS" AS "fishing_depth_fathoms",
        "BOTTOM_DEPTH_FATHOMS" AS "bottom_depth_fathoms",
        "RETRIEVAL_DATE" AS "retrieval_date",
        "DURATION_IN_MIN" AS "duration_in_min",
        "LOCATION" AS "location",
        "RETRV_LATITUDE" AS "retrv_latitude",
        "RETRV_LONGITUDE" AS "retrv_longitude",
        "RETRV_LATITUDE_SECONDS" AS "retrv_latitude_seconds",
        "RETRV_LONGITUDE_SECONDS" AS "retrv_longitude_seconds",
        "RETRV_LONGITUDE_CONVERTED" AS "retrv_longitude_converted",
        "RETRV_E_W" AS "retrv_e_w",
        "GENERIC_AREA" AS "generic_area",
        "NMFS_AREA" AS "nmfs_area",
        "COBLZ_AREA" AS "coblz_area",
        "VESSEL_ESTIMATE" AS "vessel_estimate",
        "OFFICIAL_TOTAL_CATCH" AS "official_total_catch",
        "OBSERVER_ESTIMATE" AS "observer_estimate",
        "OBSERVER_ESTIMATE_METHOD" AS "observer_estimate_method",
        "DENSITY" AS "density",
        "CATCHER_BOAT_ADFG" AS "catcher_boat_adfg",
        "IFQ" AS "ifq",
        "CDQ_CODE" AS "cdq_code",
        "SKATES_IN_SET" AS "skates_in_set",
        "HOOKS_PER_SKATE" AS "hooks_per_skate",
        "TOTAL_HOOK_POTS" AS "total_hook_pots",
        "HAUL_SAMPLED_BY" AS "haul_sampled_by",
        "RANDOM_SAMPLE_TABLE" AS "random_sample_table",
        "RANDOM_BREAK_TABLE" AS "random_break_table",
        "MM_PERCENT_MONITORED" AS "mm_percent_monitored",
        "BIRD_DETERRENCE" AS "bird_deterrence",
        "BIRD_VERIFICATION" AS "bird_verification",
        "PROCESSOR" AS "processor",
        "FISHING_START_DATE" AS "fishing_start_date",
        "DATE_OF_ENTRY" AS "date_of_entry",
        "YEAR" AS "year",
        "LATDD_END" AS "latdd_end",
        "LONDD_END" AS "londd_end",
        "LATDD_START" AS "latdd_start",
        "LONDD_START" AS "londd_start",
        "SEABIRD_SAMPLE_TYPE" AS "seabird_sample_type",
        "ATLAS_VERSION" AS "atlas_version",
        "AKFIN_LOAD_DATE" AS "akfin_load_date",
        "GEAR_DESCRIPTION" AS "gear_description",
        "AK_GEAR" AS "ak_gear",
        "GEAR_PERFORMANCE_DESCRIPTION" AS "gear_performance_description",
        "FMP_AREA" AS "fmp_area",
        "FMP_SUBAREA" AS "fmp_subarea",
        "FMP_GEAR" AS "fmp_gear",
        "DEPLOYMENT_TRIP_PK" AS "deployment_trip_pk",
        "DEPLOYMENT_TRIP_START_DATE" AS "deployment_trip_start_date",
        "DEPLOYMENT_TRIP_END_DATE" AS "deployment_trip_end_date",
        "SAMPLING_STRATA" AS "sampling_strata",
        "SAMPLING_STRATA_NAME" AS "sampling_strata_name",
        "SAMPLING_STRATA_DEPLOYMENT_CATEGORY" AS "sampling_strata_deployment_category",
        "SAMPLING_STRATA_SELECTION_RATE" AS "sampling_strata_selection_rate",
        "MONITORING_STATUS" AS "monitoring_status",
        "HAUL_TARGET_CODE" AS "haul_target_code",
        "TRIP_TARGET_CODE" AS "trip_target_code",
        "HAUL_TARGET_NAME" AS "haul_target_name",
        "TRIP_TARGET_NAME" AS "trip_target_name",
        "GEAR_MODIFIER_DESCRIPTION" AS "gear_modifier_description",
        "AKFIN_VDATE" AS "akfin_vdate"
      FROM (norpac.debriefed_haul_mv) "q03"
    ) "q04"
  ) "RHS"
    ON (
      "LHS"."join_key" = "RHS"."join_key" AND
      "LHS"."fmp_subarea" = "RHS"."fmp_subarea"
    )
) "q05"
WHERE
  ("year" <= 2023.0 AND "year" > 0.0) AND
  ("fmp_subarea" IN ('WG', 'CG', 'WY', 'EY', 'SE')) AND
  ("species" IN (301.0)) AND
  (NOT(("length" IS NULL)))
ORDER BY "year"
